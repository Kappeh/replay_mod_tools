# replay_mod_tools
A collection of tools for use with Minecraft Replay Mod

### Building and Running with Cargo
To build a package with cargo, run the following command from the root of the repository, replacing `PACKAGE` with the name of the tool and providing `OPTIONS` and `ARGS` as specified in the tools usage section.
```sh
cargo build --release -p PACKAGE -- [OPTIONS] <ARGS>
```
This will build the binary file `target/release/PACKAGE`, ready to be executed.
```sh
target/release/PACKAGE [OPTIONS] <ARGS>
```
Alternatively, packages can be run directly with cargo.
```sh
cargo run --release -p PACKAGE -- [OPTIONS] <ARGS>
```

## unpack_depth_map
A command-line tool designed to transform the output of Minecraft's Replay Mod by unpacking depth map images.

Replay Mod generates depth information encoded as a 32 bit floating-point depth value split across the 4 channels (Alpha, Red, Green, Blue) of each pixel.
This tool extracts the depth information from each frame in the PNG sequence and renders a new grayscale sequence based on the depth values.
The grayscale images represent the relative depth of each pixel, with the depth value being mapped to a grayscale intensity based on user-specified near and far plane parameters.

### Usage
```sh
unpack_depth_map [OPTIONS]
```

### Options
| short | long | env | default | description |
| --- | --- | --- | --- | --- |
| `-s` | `--source_dir` | `SOURCE_DIR` | `.` | The path of the directory containing the depth map sequence generated by replay mod |
| | `--source_suffix` | `SOURCE_SUFFIX` | `.depth.png` | The suffix of the depth map sequence files |
| `-d` | `--dest_dir` | `DEST_DIR` | source directory | The path of the directory to save the unpacked depth map sequence, defaults to the source directory |
| | `--dest_suffix` | `DEST_SUFFIX` | `.unpacked.png` | The suffix for the unpacked depth map sequence files |
| `-n` | `--near` | `NEAR` | `0.0` | The near plane distance, pixels with this depth value are rendered white |
| `-f` | `--far` | `FAR` | `50.0` | The far plane distance, pixels with this depth value are rendered black |
| `-w` | `--num_workers` | `NUM_WORKERS` | cpu core count | The number of workers (threads) to spawn |
| `-h` | `--help` | | | Print help |
| `-V` | `--version` | | | Print version |
